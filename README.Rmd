---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# AirVizR

<!-- badges: start -->
<!-- badges: end -->

The goal of AirVizR is to act as a tool for extracting, wrangling, correcting, and visualizing spatio-temporal atmospheric data, with an emphasis on fine particulate matter (PM2.5, i.e. Particulate Matter with a diameter <2.5 Âµm) data from [PurpleAir](https://www.purpleair.com/).
Correction factor equations from the [Environmental Protection Agency (EPA)](https://www.epa.gov/) and [Lane Regional Air Protection Agency (LRAPA)](https://www.lrapa.org/) are implemented to allow for greatest data accuracy.
Visualization functions have been carefully selected to maximize accessibility and data transparency.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("gmcginnis/AirVizR")
```

```{r libraries}
library(tidyverse)
library(AirVizR)
```

## Wrangling options:

One of three methods of data importation are documented in the vignettes, via either API or local import;
* **API (for PurpleAir)**:
* **Local data**
  + **PurpleAir**: Many of the same arguments as the API setup can be used. You can download data from PurpleAir's sensor [download tool](https://www.purpleair.com/sensorlist). It should be noted that this data does not include as much information as API data, including meta information regarding high values or A/B monitor sensor diaprity.
  + **FRM**: The examples in this package use FRM data from Oregon's DEQ


## Exaple Visualizations:


### Map Spatio-Temporal Data

```{r example_map_stad}
map_stad(july_api_daily, pm25_atm, location_data = july_api_meta, grouping_vars = "date_tag")
```


### Heatmaps

```{r example_heatmap_single}
heatmap_single(dataset = july_api_hourly, pm25_epa_2021, "Lighthouse", location_data = july_api_meta)
```

Avoid washed out color palettes by applying a discrete cap

```{r example_heatmap_cross}
#Before
heatmap_cross(july_api_hourly, pm25_epa_2021, location_data = july_api_meta)

#After
heatmap_cross(july_api_hourly, pm25_epa_2021, location_data = july_api_meta, cap_value = 50, cap_color = "green")
```

### Timeseries line graphs

#### Spatio-temporal

```{r example_ts_line}
ts_line(july_api_hourly, pm25_atm, label_filter = "STAR", location_data = july_api_meta, add_points = TRUE)
```

#### Variation

The following uses the [timeVariation() function](https://bookdown.org/david_carslaw/openair/sec-timeVariation.html) from the [OpenAir package](https://bookdown.org/david_carslaw/openair/).

```{r example_ts_variation}
ts_variation(july_api_hourly, "pm25_epa_2021", include = "Lighthouse", group = "date_tag", location_data = july_api_meta)
```
